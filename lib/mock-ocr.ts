/**
 * モックOCR処理
 * 開発環境やAPIクォータ不足時に使用
 */

/**
 * サンプルの面談メモテキスト
 */
const SAMPLE_MEMO_TEXTS = [
  `【面談記録】2024年12月3日

参加者：支援者A、当事者B

■ 本日の様子
- 表情は前回より明るい印象
- 会話のテンポは落ち着いている
- 視線を合わせる時間が増えた

■ 話した内容
1. 最近の生活リズムについて
   - 起床時間：午前10時頃
   - 就寝時間：午前2時頃
   - 食事：1日2食（昼と夜）

2. 気になっていること
   - 外出への不安が少し和らいできた
   - 近所のコンビニまで行けるようになった
   - ただし、人が多い時間帯は避けている

3. 今後の目標
   - 週1回の外出を続ける
   - 散歩の時間を少しずつ延ばす

■ 次回の予定
- 2週間後、同時刻
- 外出記録をつけてみる`,

  `面談メモ

日時：2024年12月3日 14:00-15:00

■ 今日の気分
☆☆☆☆☆☆☆☆☆☆
（10段階で7くらい）

■ 話したこと
・最近、本を読むようになった
・オンラインで友人と話した
・睡眠の質が改善してきた

■ 困っていること
・まだ家族以外との会話は緊張する
・長時間外にいると疲れる

■ 次のステップ
1. 図書館に行ってみる
2. オンライン通話の頻度を増やす
3. 日記を続ける

支援者所見：
少しずつ前向きな変化が見られる。
無理のないペースで進めていく。`,

  `支援記録

当事者ID: 匿名
日付: 2024年12月3日

【本日の活動】
□ 朝食 7:00
□ 散歩 10:30（20分）
□ 昼食 12:30
□ 読書 14:00-15:00
□ 面談 15:00-16:00
□ 夕食 18:30

【体調】
・睡眠時間：7時間
・食欲：良好
・疲労感：普通

【話題】
・最近興味を持っていること
・将来の目標について
・家族との関係

【次回までの課題】
1. 毎日30分の散歩
2. 生活記録をつける
3. 興味のある活動を探す

【支援者コメント】
コミュニケーションが
スムーズになってきている。
本人のペースを大切にしながら
サポートを継続する。`,
];

/**
 * モックOCR処理
 * ランダムにサンプルテキストを返す
 */
export async function mockOCRProcessing(fileName: string): Promise<string> {
  // 処理時間をシミュレート（1-2秒）
  await new Promise((resolve) => setTimeout(resolve, 1000 + Math.random() * 1000));

  // ランダムにサンプルテキストを選択
  const randomIndex = Math.floor(Math.random() * SAMPLE_MEMO_TEXTS.length);
  const sampleText = SAMPLE_MEMO_TEXTS[randomIndex];

  // ファイル名を含めたヘッダーを追加
  return `[アップロードファイル: ${fileName}]\n[※ モック実装: サンプルテキストを表示しています]\n\n${sampleText}`;
}

/**
 * OpenAI APIが利用可能かチェック
 */
export function isOpenAIAvailable(): boolean {
  return !!process.env.OPENAI_API_KEY && process.env.USE_MOCK_OCR !== "true";
}

/**
 * サンプルの音声文字起こしテキスト
 */
const SAMPLE_TRANSCRIPTS = [
  `支援者: こんにちは。今日の調子はどうですか?
当事者: まあまあです。最近は少し外に出る気持ちが出てきました。
支援者: それは良い兆候ですね。具体的にどんなことをしたいと思っていますか?
当事者: 近所のコンビニに行ってみたいです。でも、人が多いと不安になります。
支援者: その気持ちはよく分かります。まずは人が少ない時間帯を選んでみるのはどうでしょう?
当事者: そうですね。朝早い時間なら大丈夫かもしれません。`,

  `支援者: 前回のお話から、何か変化はありましたか?
当事者: 実は、家族と少し話せるようになりました。
支援者: それは素晴らしいですね。どんな話をされましたか?
当事者: 最近見ているアニメの話とか、些細なことですけど。
支援者: 些細なことでも、コミュニケーションが取れているのは大きな進歩です。
当事者: ありがとうございます。少しずつですが、前に進んでいる気がします。`,

  `支援者: 今日は少し疲れているように見えますが、大丈夫ですか?
当事者: 昨日あまり眠れなくて...また不安が強くなってきました。
支援者: 何か特別な出来事がありましたか?
当事者: 特にないんですが、将来のことを考えると怖くなります。
支援者: その気持ちは自然なことです。一緒に小さな目標から考えていきましょう。
当事者: はい...でも、本当に自分が変われるのか不安です。`,
];

/**
 * モック音声文字起こし処理
 * ランダムにサンプルテキストを返す
 */
export async function mockTranscribeAudio(fileName: string): Promise<string> {
  // 処理時間をシミュレート（2-4秒）
  await new Promise((resolve) => setTimeout(resolve, 2000 + Math.random() * 2000));

  // ランダムにサンプルテキストを選択
  const randomIndex = Math.floor(Math.random() * SAMPLE_TRANSCRIPTS.length);
  const sampleText = SAMPLE_TRANSCRIPTS[randomIndex];

  // ファイル名を含めたヘッダーを追加
  return `[アップロード音声ファイル: ${fileName}]\n[※ モック実装: サンプルテキストを表示しています]\n\n${sampleText}`;
}












