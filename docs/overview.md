# ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ãƒãƒªã‚·ãƒ¼

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ã²ãã“ã‚‚ã‚Šæ”¯æ´Ã—AIæœ€é©åŒ–ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€è¨­è¨ˆæ€æƒ³ã€é–‹ç™ºãƒãƒªã‚·ãƒ¼ã«ã¤ã„ã¦è©³ç´°ã«èª¬æ˜ã—ã¾ã™ã€‚

## ç›®æ¬¡

- [1. ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#1-ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
- [2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°](#2-æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°)
- [3. è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#3-è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)
- [4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼](#4-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼)
- [5. é–‹ç™ºãƒãƒªã‚·ãƒ¼](#5-é–‹ç™ºãƒãƒªã‚·ãƒ¼)
- [6. ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#6-ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
- [7. å¤–éƒ¨APIé€£æºï¼ˆäºˆå®šï¼‰](#7-å¤–éƒ¨apié€£æºäºˆå®š)
- [8. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–](#8-ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–)

---

## 1. ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 1.1 å…¨ä½“æ§‹æˆ

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ã€Next.js 15ã®App Routerã‚’åŸºç›¤ã¨ã—ãŸãƒ¢ãƒ€ãƒ³ãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ãƒ¦ãƒ¼ã‚¶ãƒ¼                              â”‚
â”‚            (æ”¯æ´è€…ãƒ»ç®¡ç†è€…ãƒ»ç¦ç¥‰æ–½è¨­è·å“¡)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTPS
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Next.js Frontend                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  App Router (React Server Components)           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰                               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ä¼šè©±ãƒ‡ãƒ¼ã‚¿åé›†                               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ãƒã‚¤ã‚¿ãƒ«ãƒ‡ãƒ¼ã‚¿åé›†                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»åˆ†æ                             â”‚   â”‚
â”‚  â”‚  â””â”€â”€ ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  UI Components (Shadcn UI + Radix UI)           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Backend API Layer (äºˆå®š)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Next.js API Routes / Server Actions            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Database â”‚  â”‚ AI/ML    â”‚  â”‚ External     â”‚
â”‚ (äºˆå®š)    â”‚  â”‚ Services â”‚  â”‚ APIs         â”‚
â”‚          â”‚  â”‚ (äºˆå®š)    â”‚  â”‚ (äºˆå®š)        â”‚
â”‚PostgreSQLâ”‚  â”‚ OpenAI   â”‚  â”‚ - Fitbit     â”‚
â”‚ + Prisma â”‚  â”‚ SageMakerâ”‚  â”‚ - Azure      â”‚
â”‚          â”‚  â”‚          â”‚  â”‚   Speech     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼š

#### ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ (Presentation Layer)
- **è²¬å‹™**: UI/UXã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
- **æŠ€è¡“**: Next.js App Routerã€React Server Componentsã€Shadcn UI
- **å ´æ‰€**: `app/`, `components/`

#### ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ (Business Logic Layer)
- **è²¬å‹™**: ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã€åˆ†æãƒ­ã‚¸ãƒƒã‚¯ã€ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«
- **æŠ€è¡“**: Next.js Server Actionsã€TypeScript
- **å ´æ‰€**: `lib/`ï¼ˆç¾åœ¨ã¯ãƒ¢ãƒƒã‚¯å®Ÿè£…ï¼‰

#### ãƒ‡ãƒ¼ã‚¿å±¤ (Data Layer)
- **è²¬å‹™**: ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã€å¤–éƒ¨APIé€£æº
- **æŠ€è¡“**: PostgreSQL + Prismaï¼ˆäºˆå®šï¼‰ã€å¤–éƒ¨API
- **å ´æ‰€**: `prisma/`ï¼ˆäºˆå®šï¼‰ã€API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

### 1.3 ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹

**MVP Phase 1ï¼ˆå®Œäº†ï¼‰**: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ãŸãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

- âœ… UI/UXã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Œæˆ
- âœ… ãƒšãƒ¼ã‚¸é·ç§»ãƒ»ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…
- âœ… ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹å‹•ä½œç¢ºèª
- â³ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ APIå®Ÿè£…ï¼ˆPhase 2 - 2ãƒ¶æœˆä»¥å†…é–‹å§‹ï¼‰
- â³ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®Ÿè£…ï¼ˆPhase 2 - Vercel Postgres + Prismaï¼‰
- â³ å¤–éƒ¨APIé€£æºï¼ˆPhase 3ï¼‰

**é–‹ç™ºä½“åˆ¶**: 2åä½“åˆ¶  
**æ¬¡ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³**: PoCå®Ÿè¨¼ï¼ˆåŠå¹´å¾Œäºˆå®šï¼‰

---

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°

### 2.1 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|---------|------|-----------|------|
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Next.js | 15.2.4 | App Routerã€SSR/SSG |
| è¨€èª | TypeScript | 5.x | å‹å®‰å…¨æ€§ |
| UIãƒ©ã‚¤ãƒ–ãƒ©ãƒª | React | 19.x | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–‹ç™º |
| ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° | Tailwind CSS | 4.1.9 | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆCSS |
| UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | Shadcn UI | - | å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ– | Radix UI | - | ã‚¢ã‚¯ã‚»ã‚·ãƒ–ãƒ«ãªUIåŸºç›¤ |
| ãƒãƒ£ãƒ¼ãƒˆ | Recharts | latest | ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ– |
| ãƒ•ã‚©ãƒ¼ãƒ  | React Hook Form | 7.60.0 | ãƒ•ã‚©ãƒ¼ãƒ ç®¡ç† |
| ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ | Zod | 3.25.67 | ã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
| ãƒ†ãƒ¼ãƒ | next-themes | 0.4.6 | ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ |
| ã‚¢ã‚¤ã‚³ãƒ³ | Lucide React | 0.454.0 | ã‚¢ã‚¤ã‚³ãƒ³ã‚»ãƒƒãƒˆ |
| é€šçŸ¥ | Sonner | 1.7.4 | ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ |

### 2.2 é–‹ç™ºç’°å¢ƒ

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | èª¬æ˜ |
|---------|------|------|
| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ | pnpm | é«˜é€Ÿã§åŠ¹ç‡çš„ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç† |
| ãƒªãƒ³ã‚¿ãƒ¼ | ESLint | ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ |
| å‹ãƒã‚§ãƒƒã‚¯ | TypeScript Compiler | é™çš„å‹ãƒã‚§ãƒƒã‚¯ |
| Git | Git | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† |

### 2.3 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆäºˆå®šï¼‰

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | ç”¨é€” |
|---------|------|------|
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | PostgreSQL (Vercel Postgres) | ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| ORM | Prisma | å‹å®‰å…¨ãªDBæ“ä½œ |
| èªè¨¼ | **Auth0** âœ… | ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒ»èªå¯ |
| AI/ML | OpenAI GPT-4 | è‡ªç„¶è¨€èªå‡¦ç†ãƒ»åˆ†æ |
| AI/ML | Vercel AI SDK (äºˆå®š) | æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®çµ±åˆ |
| ãƒã‚¤ã‚¿ãƒ«ãƒ‡ãƒ¼ã‚¿ | Fitbit Web API | å¿ƒæ‹ãƒ»æ´»å‹•é‡ãƒ»ç¡çœ ãƒ‡ãƒ¼ã‚¿å–å¾— |
| éŸ³å£°èªè­˜ | Azure Speech Services | éŸ³å£°â†’ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ› |
| ã‚¯ãƒ©ã‚¦ãƒ‰ | **Vercel** âœ… | ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ»ã‚¤ãƒ³ãƒ•ãƒ© |

---

## 3. è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 3.1 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

#### Server Componentså„ªå…ˆ

Next.js 15ã®App Routerã§ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§Server Componentsã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```typescript
// âœ… Good: Server Componentï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
export default function DashboardPage() {
  // ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãªã©ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰å‡¦ç†
  return <DashboardOverview />
}

// âœ… Good: Client Componentã¯å¿…è¦ãªå ´åˆã®ã¿
"use client"
export function InteractiveChart() {
  const [data, setData] = useState([])
  // ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ­ã‚¸ãƒƒã‚¯
  return <Chart data={data} />
}
```

#### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

```typescript
// components/feature/example-component.tsx

"use client" // Client Componentã®å ´åˆã®ã¿

import { useState } from "react"
import { Button } from "@/components/ui/button"

// 1. å‹å®šç¾©
interface ExampleComponentProps {
  title: string
  onSubmit: (value: string) => void
}

// 2. ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼‰
export function ExampleComponent({ title, onSubmit }: ExampleComponentProps) {
  const [value, setValue] = useState("")

  const handleSubmit = () => {
    onSubmit(value)
  }

  return (
    <div>
      <h2>{title}</h2>
      <SubComponent value={value} onChange={setValue} />
      <Button onClick={handleSubmit}>é€ä¿¡</Button>
    </div>
  )
}

// 3. ã‚µãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
function SubComponent({ 
  value, 
  onChange 
}: { 
  value: string
  onChange: (v: string) => void 
}) {
  return <input value={value} onChange={(e) => onChange(e.target.value)} />
}

// 4. ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
function formatValue(value: string): string {
  return value.trim().toLowerCase()
}
```

### 3.2 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ è¦ç´„

```
app/
  dashboard/          # æ©Ÿèƒ½ã”ã¨ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åˆ†å‰²
    [feature]/
      page.tsx        # ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
      layout.tsx      # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆå¿…è¦ãªå ´åˆï¼‰
      loading.tsx     # ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°UI
      error.tsx       # ã‚¨ãƒ©ãƒ¼UI

components/
  [feature]/          # æ©Ÿèƒ½ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
    feature-main.tsx
    feature-sub.tsx
  ui/                 # å…±é€šUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    button.tsx
    card.tsx
  dashboard/          # æ¨ªæ–­çš„ãªå…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    dashboard-layout.tsx

lib/
  [feature].ts        # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
  utils.ts            # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
```

### 3.3 çŠ¶æ…‹ç®¡ç†

ç¾åœ¨ã®å®Ÿè£…ã§ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆï¼ˆ`useState`ï¼‰ã‚’ä¸­å¿ƒã«ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

```typescript
// âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆã§ååˆ†ãªå ´åˆ
const [isLoading, setIsLoading] = useState(false)

// ğŸ”„ å°†æ¥çš„ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆãŒå¿…è¦ãªå ´åˆ
// - React Context
// - Zustand
// - Jotai
```

### 3.4 ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ‘ã‚¿ãƒ¼ãƒ³

```typescript
// Server Componentã§ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒï¼ˆäºˆå®šï¼‰
export default async function DataPage() {
  const data = await fetchData() // ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§å®Ÿè¡Œ
  return <DataView data={data} />
}

// Client Componentã§ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒï¼ˆç¾åœ¨ï¼‰
"use client"
export function DataComponent() {
  const [data, setData] = useState(null)
  
  useEffect(() => {
    async function loadData() {
      const result = await fetchData()
      setData(result)
    }
    loadData()
  }, [])
  
  return <DataView data={data} />
}
```

### 3.5 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
// ã‚¨ãƒ©ãƒ¼ãƒã‚¦ãƒ³ãƒ€ãƒªï¼ˆapp/error.tsxï¼‰
"use client"

export default function Error({
  error,
  reset,
}: {
  error: Error & { digest?: string }
  reset: () => void
}) {
  return (
    <div>
      <h2>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h2>
      <button onClick={() => reset()}>å†è©¦è¡Œ</button>
    </div>
  )
}

// Try-Catch ãƒ‘ã‚¿ãƒ¼ãƒ³
async function handleSubmit() {
  try {
    await submitData()
  } catch (error) {
    console.error("ã‚¨ãƒ©ãƒ¼:", error)
    showErrorToast("é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ")
  }
}
```

---

## 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼

### 4.1 ãƒ‡ãƒ¼ã‚¿ä¿è­·

#### å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„

- **åŸå‰‡**: å€‹äººæƒ…å ±ã¯åŒ¿åçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å‡¦ç†
- **ç¦æ­¢**: å€‹äººã«ç´ã¥ãæƒ…å ±ã®ç›´æ¥ä½¿ç”¨
- **æº–æ‹ **: å€‹äººæƒ…å ±ä¿è­·æ³•

```typescript
// âœ… åŒ¿ååŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿
interface AnonymizedData {
  userId: string        // ãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚ŒãŸID
  timestamp: Date
  vitalMetrics: number[]
  // å€‹äººã‚’ç‰¹å®šã§ãã‚‹æƒ…å ±ã¯å«ã¾ãªã„
}

// âŒ å€‹äººæƒ…å ±ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ï¼ˆä½¿ç”¨ç¦æ­¢ï¼‰
interface PersonalData {
  name: string          // NG
  address: string       // NG
  phoneNumber: string   // NG
}
```

#### ãƒ‡ãƒ¼ã‚¿åŒ¿ååŒ–ãƒ•ãƒ­ãƒ¼

```
ç”Ÿãƒ‡ãƒ¼ã‚¿ â†’ åŒ¿ååŒ–å‡¦ç† â†’ çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ â†’ åˆ†æãƒ»è¡¨ç¤º
         (å€‹äººæƒ…å ±é™¤å»)  (é›†ç´„ãƒ»å¹³å‡åŒ–)
```

### 4.2 èªè¨¼ãƒ»èªå¯

#### ç¾åœ¨ï¼ˆãƒ¢ãƒƒã‚¯å®Ÿè£…ï¼‰

```typescript
// lib/mock-auth.ts
export async function mockLogin(email: string, password: string) {
  // ãƒ†ã‚¹ãƒˆç”¨ã®ã‚·ãƒ³ãƒ—ãƒ«ãªèªè¨¼
  if (email === "supporter@example.com" && password === "password123") {
    return { success: true, user: { email, role: "supporter" } }
  }
  return { success: false, error: "èªè¨¼å¤±æ•—" }
}
```

#### å°†æ¥ï¼ˆæœ¬ç•ªå®Ÿè£…ï¼‰

- **èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**: **Auth0** âœ… é¸å®šæ¸ˆã¿
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: JWT (JSON Web Token) via Auth0
- **æ¨©é™ç®¡ç†**: RBAC (Role-Based Access Control)
- **å®Ÿè£…äºˆå®š**: Phase 2ï¼ˆ2ãƒ¶æœˆä»¥å†…é–‹å§‹ï¼‰

```typescript
// å°†æ¥ã®å®Ÿè£…ã‚¤ãƒ¡ãƒ¼ã‚¸
interface User {
  id: string
  email: string
  role: "admin" | "supporter" | "facility_staff"
  permissions: string[]
}

// ãƒ­ãƒ¼ãƒ«ã«åŸºã¥ãã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
function requireRole(role: User["role"]) {
  // ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ãƒ­ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯
}
```

### 4.3 é€šä¿¡ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- **HTTPSå¿…é ˆ**: ã™ã¹ã¦ã®é€šä¿¡ã‚’æš—å·åŒ–
- **CORSè¨­å®š**: é©åˆ‡ãªCORS policy
- **CSRFå¯¾ç­–**: Next.jsã®çµ„ã¿è¾¼ã¿ä¿è­·
- **XSSå¯¾ç­–**: React/Next.jsã®è‡ªå‹•ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—

### 4.4 ç›£æŸ»ãƒ­ã‚°

ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¥æ­´ã‚’è¨˜éŒ²ï¼ˆäºˆå®šï¼‰ï¼š

```typescript
interface AuditLog {
  timestamp: Date
  userId: string
  action: string        // "view", "edit", "delete"
  resource: string      // "conversation", "vital_data"
  ipAddress: string
  result: "success" | "failure"
}

// ãƒ­ã‚°ä¿æŒæœŸé–“: 3å¹´é–“
```

---

## 5. é–‹ç™ºãƒãƒªã‚·ãƒ¼

### 5.1 ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

#### TypeScript

```typescript
// âœ… interfaceã‚’å„ªå…ˆ
interface User {
  id: string
  name: string
}

// âŒ typeã¯é¿ã‘ã‚‹ï¼ˆunionã‚„intersectionã®å ´åˆã¯ä½¿ç”¨å¯ï¼‰
type User = {
  id: string
  name: string
}

// âœ… enumã¯é¿ã‘ã€mapã‚’ä½¿ç”¨
const UserRole = {
  ADMIN: "admin",
  SUPPORTER: "supporter",
} as const

// âŒ enum
enum UserRole {
  ADMIN = "admin",
  SUPPORTER = "supporter",
}
```

#### å‘½åè¦å‰‡

```typescript
// ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: ãƒ€ãƒƒã‚·ãƒ¥ä»˜ãå°æ–‡å­—
components/auth-wizard/

// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: PascalCase
export function UserProfile() { }

// å¤‰æ•°ãƒ»é–¢æ•°: camelCase
const isLoading = true
function handleSubmit() { }

// å®šæ•°: UPPER_SNAKE_CASE
const MAX_RETRY_COUNT = 3

// çœŸå½å€¤: is/has/should prefix
const isValid = true
const hasError = false
const shouldRender = true
```

#### é–¢æ•°å®£è¨€

```typescript
// âœ… ç´”ç²‹é–¢æ•°ã«ã¯"function"ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
function calculateScore(data: number[]): number {
  return data.reduce((sum, val) => sum + val, 0)
}

// âœ… ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¯ã‚¢ãƒ­ãƒ¼é–¢æ•°ã‚‚å¯
const handleClick = () => {
  console.log("clicked")
}
```

### 5.2 UIã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

#### Tailwind CSS

```typescript
// âœ… ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨
<div className="flex items-center gap-4 p-4 bg-background rounded-lg">
  <span className="text-sm font-medium text-foreground">ãƒ©ãƒ™ãƒ«</span>
</div>

// âœ… æ¡ä»¶ä»˜ãã‚¹ã‚¿ã‚¤ãƒ«
<div className={cn(
  "base-styles",
  isActive && "active-styles",
  variant === "primary" && "primary-styles"
)}>
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³

```typescript
// ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
<div className="
  flex flex-col         // ãƒ¢ãƒã‚¤ãƒ«: ç¸¦ä¸¦ã³
  md:flex-row          // ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆä»¥ä¸Š: æ¨ªä¸¦ã³
  lg:gap-6             // PC: ã‚®ãƒ£ãƒƒãƒ—å¤§
">
```

### 5.3 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

#### Server Componentså„ªå…ˆ

```typescript
// âœ… ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§Server Component
export default function StaticContent() {
  return <div>é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</div>
}

// âœ… ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªéƒ¨åˆ†ã®ã¿Client Component
"use client"
export function InteractiveWidget() {
  const [state, setState] = useState()
  return <div onClick={() => setState()}>ã‚¯ãƒªãƒƒã‚¯</div>
}
```

#### å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```typescript
// é‡ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å‹•çš„ãƒ­ãƒ¼ãƒ‰
import dynamic from 'next/dynamic'

const HeavyChart = dynamic(() => import('./heavy-chart'), {
  loading: () => <Spinner />,
  ssr: false
})
```

### 5.4 ãƒ†ã‚¹ãƒˆãƒãƒªã‚·ãƒ¼ï¼ˆäºˆå®šï¼‰

```typescript
// ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
describe("calculateScore", () => {
  it("æ­£ã—ãã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã™ã‚‹", () => {
    expect(calculateScore([1, 2, 3])).toBe(6)
  })
})

// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
describe("LoginForm", () => {
  it("ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã«onSubmitãŒå‘¼ã°ã‚Œã‚‹", () => {
    // ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
  })
})
```

---

## 6. ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 6.1 ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆäºˆå®šï¼‰

```prisma
// prisma/schema.prisma

// ãƒ¦ãƒ¼ã‚¶ãƒ¼
model User {
  id        String   @id @default(uuid())
  email     String   @unique
  role      Role
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Role {
  ADMIN
  SUPPORTER
  FACILITY_STAFF
}

// å½“äº‹è€…ï¼ˆåŒ¿ååŒ–ï¼‰
model Patient {
  id              String   @id @default(uuid())
  anonymousId     String   @unique // åŒ¿ååŒ–ã•ã‚ŒãŸID
  conversations   Conversation[]
  vitalData       VitalData[]
  supportRecords  SupportRecord[]
  createdAt       DateTime @default(now())
}

// ä¼šè©±ãƒ‡ãƒ¼ã‚¿
model Conversation {
  id          String   @id @default(uuid())
  patientId   String
  patient     Patient  @relation(fields: [patientId], references: [id])
  transcript  String   // ãƒ†ã‚­ã‚¹ãƒˆåŒ–ã•ã‚ŒãŸä¼šè©±
  sentiment   Json     // æ„Ÿæƒ…åˆ†æçµæœ
  keywords    Json     // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡ºçµæœ
  recordedAt  DateTime
  createdAt   DateTime @default(now())
}

// ãƒã‚¤ã‚¿ãƒ«ãƒ‡ãƒ¼ã‚¿
model VitalData {
  id              String   @id @default(uuid())
  patientId       String
  patient         Patient  @relation(fields: [patientId], references: [id])
  heartRate       Int
  steps           Int
  sleepDuration   Float
  stressLevel     String
  recordedAt      DateTime
  createdAt       DateTime @default(now())
}

// æ”¯æ´è¨˜éŒ²
model SupportRecord {
  id              String   @id @default(uuid())
  patientId       String
  patient         Patient  @relation(fields: [patientId], references: [id])
  supporterId     String
  approach        String   // æ”¯æ´ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
  result          String   // çµæœ
  notes           String   // ãƒ¡ãƒ¢
  recordedAt      DateTime
  createdAt       DateTime @default(now())
}

// åˆ†æçµæœ
model AnalysisResult {
  id                String   @id @default(uuid())
  patientId         String
  overallScore      Int
  riskLevel         String
  recommendations   Json
  similarCases      Json
  analyzedAt        DateTime
  createdAt         DateTime @default(now())
}
```

### 6.2 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ•ãƒ­ãƒ³ãƒˆ      â”‚  ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆZodï¼‰
â”‚ ã‚¨ãƒ³ãƒ‰        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ API Layer    â”‚  èªè¨¼ãƒ»èªå¯ãƒã‚§ãƒƒã‚¯
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ“ã‚¸ãƒã‚¹      â”‚  ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»åŒ¿ååŒ–
â”‚ ãƒ­ã‚¸ãƒƒã‚¯      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹  â”‚  æ°¸ç¶šåŒ–
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. å¤–éƒ¨APIé€£æºï¼ˆäºˆå®šï¼‰

### 7.1 Fitbit Web API

å¿ƒæ‹ãƒ»æ´»å‹•é‡ãƒ»ç¡çœ ãƒ‡ãƒ¼ã‚¿ã®å–å¾—

```typescript
// å°†æ¥ã®å®Ÿè£…ã‚¤ãƒ¡ãƒ¼ã‚¸
interface FitbitClient {
  getHeartRate(userId: string, date: Date): Promise<HeartRateData>
  getActivitySummary(userId: string, date: Date): Promise<ActivityData>
  getSleepLog(userId: string, date: Date): Promise<SleepData>
}

// APIåˆ¶é™: 1æ—¥150å›ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
// ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥: æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•
```

### 7.2 OpenAI GPT-4

è‡ªç„¶è¨€èªå‡¦ç†ãƒ»æ„Ÿæƒ…åˆ†æ

```typescript
interface OpenAIClient {
  analyzeConversation(transcript: string): Promise<{
    sentiment: string
    keywords: string[]
    psychologicalState: Record<string, number>
  }>
  
  generateRecommendations(context: AnalysisContext): Promise<string[]>
}
```

### 7.3 Azure Speech Services

éŸ³å£°â†’ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ›

```typescript
interface SpeechClient {
  transcribeAudio(audioFile: Blob): Promise<{
    text: string
    confidence: number
  }>
}

// ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ç›®æ¨™: 3ç§’ä»¥å†…
```

---

## 8. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 8.1 ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ç›®æ¨™

| æ“ä½œ | ç›®æ¨™æ™‚é–“ |
|------|---------|
| ä¸»è¦ç”»é¢è¡¨ç¤º | 3ç§’ä»¥å†… |
| ãƒ‡ãƒ¼ã‚¿åˆ†æçµæœè¡¨ç¤º | 10ç§’ä»¥å†… |
| éŸ³å£°èªè­˜å‡¦ç† | 3ç§’ä»¥å†… |
| ãƒã‚¤ã‚¿ãƒ«ãƒ‡ãƒ¼ã‚¿åŒæœŸ | 1ç§’ä»¥å†…ã®é…å»¶ |

### 8.2 æœ€é©åŒ–æˆ¦ç•¥

#### ã‚³ãƒ¼ãƒ‰åˆ†å‰²

```typescript
// ãƒ«ãƒ¼ãƒˆãƒ™ãƒ¼ã‚¹ã®ã‚³ãƒ¼ãƒ‰åˆ†å‰²ï¼ˆNext.jsè‡ªå‹•ï¼‰
// å„ãƒšãƒ¼ã‚¸ã¯ç‹¬ç«‹ã—ãŸãƒãƒ³ãƒ‰ãƒ«

// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã®å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
const Chart = dynamic(() => import('./chart'), { ssr: false })
```

#### ç”»åƒæœ€é©åŒ–

```typescript
import Image from 'next/image'

<Image
  src="/image.jpg"
  alt="èª¬æ˜"
  width={800}
  height={600}
  loading="lazy"
  placeholder="blur"
/>
```

#### ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥ï¼ˆäºˆå®šï¼‰

```typescript
// Server Componentã§ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥
export const revalidate = 60 // 60ç§’ã”ã¨ã«å†æ¤œè¨¼

// Redisã‚­ãƒ£ãƒƒã‚·ãƒ¥
const cachedData = await redis.get(key)
if (cachedData) return cachedData

const freshData = await fetchData()
await redis.set(key, freshData, 'EX', 3600)
```

### 8.3 åŒæ™‚æ¥ç¶šæ•°å¯¾å¿œ

| å¹´åº¦ | æƒ³å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ | åŒæ™‚æ¥ç¶šæ•° |
|------|------------|-----------|
| åˆå¹´åº¦ | 2æ–½è¨­Ã—10ãƒ¦ãƒ¼ã‚¶ãƒ¼ | 20 |
| 2å¹´ç›® | 4æ–½è¨­Ã—10ãƒ¦ãƒ¼ã‚¶ãƒ¼ | 40 |
| 3å¹´ç›® | 8æ–½è¨­Ã—10ãƒ¦ãƒ¼ã‚¶ãƒ¼ | 80 |

---

## 9. é‹ç”¨ãƒ»ç›£è¦–

### 9.1 Vercelç’°å¢ƒ

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **Vercel** ã‚’ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¨ã—ã¦æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

#### Vercel ã®åˆ©ç‚¹

- **Next.jsæœ€é©åŒ–**: Next.jsã®é–‹ç™ºå…ƒã«ã‚ˆã‚‹æœ€é©åŒ–ã•ã‚ŒãŸãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°
- **è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°**: ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã«å¿œã˜ãŸè‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒ«
- **Edge Network**: ã‚°ãƒ­ãƒ¼ãƒãƒ«CDNã«ã‚ˆã‚‹é«˜é€Ÿé…ä¿¡
- **Preview Deployment**: PRã”ã¨ã®è‡ªå‹•ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒ
- **Zero Config**: æœ€å°é™ã®è¨­å®šã§æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½
- **Vercel Postgres**: PostgreSQLäº’æ›ã®ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **Analytics**: çµ„ã¿è¾¼ã¿ã®åˆ†æãƒ„ãƒ¼ãƒ«

#### ç’°å¢ƒæ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Production (æœ¬ç•ªç’°å¢ƒ)                â”‚
â”‚ - vercel.app ãƒ‰ãƒ¡ã‚¤ãƒ³                â”‚
â”‚ - Vercel Postgres (æœ¬ç•ª)            â”‚
â”‚ - Auth0 (æœ¬ç•ªãƒ†ãƒŠãƒ³ãƒˆ)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Preview (ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ)           â”‚
â”‚ - PRã”ã¨ã®è‡ªå‹•ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼URL          â”‚
â”‚ - Vercel Postgres (é–‹ç™º)            â”‚
â”‚ - Auth0 (é–‹ç™ºãƒ†ãƒŠãƒ³ãƒˆ)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Development (ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º)           â”‚
â”‚ - localhost:3000                    â”‚
â”‚ - ãƒ­ãƒ¼ã‚«ãƒ«PostgreSQL / Vercel Postgresâ”‚
â”‚ - Auth0 (é–‹ç™ºãƒ†ãƒŠãƒ³ãƒˆ)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 ãƒ­ã‚°ç®¡ç†

```typescript
// æ§‹é€ åŒ–ãƒ­ã‚°
logger.info("User action", {
  userId: user.id,
  action: "view_dashboard",
  timestamp: new Date(),
  metadata: { /* ... */ }
})

// ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
logger.error("API error", {
  error: error.message,
  stack: error.stack,
  context: { /* ... */ }
})
```

### 9.3 ç›£è¦–æŒ‡æ¨™

#### Vercel Analytics

- **Core Web Vitals**: LCPã€FIDã€CLS
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ã‚¯ã‚»ã‚¹**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¯ã‚»ã‚¹ã®å¯è¦–åŒ–
- **ãƒ‡ãƒã‚¤ã‚¹ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶åˆ†å¸ƒ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç’°å¢ƒã®æŠŠæ¡

#### Sentryï¼ˆã‚¨ãƒ©ãƒ¼ç›£è¦–ï¼‰

- **ã‚¨ãƒ©ãƒ¼ç‡**: 1%ä»¥ä¸‹
- **å¹³å‡ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“**: 3ç§’ä»¥å†…
- **APIæˆåŠŸç‡**: 99%ä»¥ä¸Š
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–**: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¿½è·¡

#### ç›®æ¨™æŒ‡æ¨™

- **ç¨¼åƒç‡**: 99.5%ä»¥ä¸Šï¼ˆVercel SLAï¼‰
- **ã‚¨ãƒ©ãƒ¼ç‡**: 1%ä»¥ä¸‹
- **å¹³å‡ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“**: 3ç§’ä»¥å†…
- **APIæˆåŠŸç‡**: 99%ä»¥ä¸Š

### 9.4 ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

- **æ—¥æ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å…¨ä½“
- **é€±æ¬¡ãƒ•ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“
- **å¾©æ—§æ™‚é–“ç›®æ¨™ï¼ˆRTOï¼‰**: 4æ™‚é–“ä»¥å†…
- **ãƒ‡ãƒ¼ã‚¿å¾©æ—§ç›®æ¨™ï¼ˆRPOï¼‰**: 1æ™‚é–“ä»¥å†…

---

## 10. Auth0 å®Ÿè£…è¨ˆç”»

### 10.1 èªè¨¼ãƒ•ãƒ­ãƒ¼

```typescript
// Auth0 SDKè¨­å®š
import { Auth0Provider, useAuth0 } from '@auth0/auth0-react'

// Auth0ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¨­å®š
const auth0Config = {
  domain: process.env.NEXT_PUBLIC_AUTH0_DOMAIN!,
  clientId: process.env.NEXT_PUBLIC_AUTH0_CLIENT_ID!,
  authorizationParams: {
    redirect_uri: typeof window !== 'undefined' ? window.location.origin : '',
    audience: process.env.NEXT_PUBLIC_AUTH0_AUDIENCE,
    scope: 'openid profile email'
  }
}

// ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
export function LoginButton() {
  const { loginWithRedirect } = useAuth0()
  
  return (
    <button onClick={() => loginWithRedirect()}>
      ãƒ­ã‚°ã‚¤ãƒ³
    </button>
  )
}

// Server-side ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
import { auth } from '@auth0/nextjs-auth0'

export async function getUserFromSession() {
  const session = await auth().getSession()
  return session?.user
}
```

### 10.2 æ¨©é™ç®¡ç†ï¼ˆRBAC with Auth0ï¼‰

```typescript
// Auth0 Management APIï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ï¼‰
import { ManagementClient } from 'auth0'

const management = new ManagementClient({
  domain: process.env.AUTH0_DOMAIN!,
  clientId: process.env.AUTH0_CLIENT_ID!,
  clientSecret: process.env.AUTH0_CLIENT_SECRET!,
})

// ãƒ­ãƒ¼ãƒ«ã®å‰²ã‚Šå½“ã¦
await management.assignRolestoUser(
  { id: userId },
  { roles: ['rol_supporter'] } // rol_admin, rol_supporter
)

// ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ¬ãƒ¼ãƒ ï¼ˆAuth0 Actionsï¼‰
exports.onExecutePostLogin = async (event, api) => {
  const namespace = 'https://yourapp.com'
  
  if (event.authorization) {
    api.idToken.setCustomClaim(`${namespace}/role`, event.user.app_metadata.role)
    api.idToken.setCustomClaim(`${namespace}/permissions`, event.user.app_metadata.permissions)
  }
}

// ãƒˆãƒ¼ã‚¯ãƒ³ã‹ã‚‰ãƒ­ãƒ¼ãƒ«å–å¾—
const decodedToken = await verifyToken(token)
const role = decodedToken['https://yourapp.com/role'] // 'supporter'
```

### 10.3 Vercelç’°å¢ƒå¤‰æ•°

```bash
# .env.local
NEXT_PUBLIC_AUTH0_DOMAIN=xxx.auth0.com
NEXT_PUBLIC_AUTH0_CLIENT_ID=xxx
NEXT_PUBLIC_AUTH0_AUDIENCE=https://api.yourapp.com
AUTH0_CLIENT_SECRET=xxx (Server only)
AUTH0_BASE_URL=http://localhost:3000 (or production URL)
```

### 10.4 Auth0 ãƒ†ãƒŠãƒ³ãƒˆè¨­å®š

#### å¿…è¦ãªè¨­å®š

1. **Applicationè¨­å®š**
   - Application Type: Single Page Application
   - Allowed Callback URLs: `http://localhost:3000/api/auth/callback`, `https://yourdomain.vercel.app/api/auth/callback`
   - Allowed Logout URLs: `http://localhost:3000`, `https://yourdomain.vercel.app`
   - Allowed Web Origins: `http://localhost:3000`, `https://yourdomain.vercel.app`

2. **APIè¨­å®š**
   - Identifier: `https://api.yourapp.com`
   - Signing Algorithm: RS256
   - RBAC Settings: Enable RBAC, Add Permissions in Access Token

3. **Roleså®šç¾©**
   - `admin`: ç®¡ç†è€…ï¼ˆå…¨æ¨©é™ï¼‰
   - `supporter`: æ”¯æ´è€…ãƒ»ç¦ç¥‰æ–½è¨­è·å“¡

4. **Permissionså®šç¾©**
   - `read:patients`: å½“äº‹è€…æƒ…å ±ã®é–²è¦§
   - `write:conversations`: ä¼šè©±ãƒ‡ãƒ¼ã‚¿ã®è¨˜éŒ²
   - `read:analytics`: åˆ†æçµæœã®é–²è¦§
   - `manage:users`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ï¼ˆadmin ã®ã¿ï¼‰

## 11. ä»Šå¾Œã®æ‹¡å¼µæ€§

### 11.1 ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£

- **Vercelè‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°**: ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã«å¿œã˜ãŸè‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒ«
- **Edge Functions**: ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®å‡¦ç†
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°**: Vercel Postgres ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—/ã‚¢ã‚¦ãƒˆ

### 11.2 çªç™ºçš„ã‚¢ã‚¯ã‚»ã‚¹å¢—å¯¾ç­–

- **Vercel Edge Network**: ã‚°ãƒ­ãƒ¼ãƒãƒ«CDNã«ã‚ˆã‚‹é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é…ä¿¡
- **Vercel KV (Redis)**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã«ã‚ˆã‚‹å¿œç­”é€Ÿåº¦å‘ä¸Š
- **ãƒªãƒˆãƒ©ã‚¤åˆ¶å¾¡ãƒ»ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³**

---

### 11.3 å›½éš›å±•é–‹ï¼ˆ5å¹´ç›®ä»¥é™ï¼‰

- å¤šè¨€èªå¯¾å¿œï¼ˆè‹±èªã€ä¸­å›½èªç­‰ï¼‰
- å„å›½ã®è¦åˆ¶å¯¾å¿œï¼ˆHIPAAç­‰ï¼‰
- ç¾åœ°ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚·ãƒƒãƒ—

### 11.4 æ©Ÿèƒ½æ‹¡å¼µ

- ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªé–‹ç™ºï¼ˆReact Native + Auth0ï¼‰
- æ±ºæ¸ˆæ©Ÿèƒ½çµ±åˆï¼ˆStripeï¼‰
- ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ
- ãƒ“ãƒ‡ã‚ªä¼šè©±åˆ†æ
- VR/ARæ”¯æ´ãƒ„ãƒ¼ãƒ«é€£æº

---

## 12. é–‹ç™ºè¨ˆç”»ã‚µãƒãƒªãƒ¼

### ç¢ºå®šäº‹é … âœ…

| é …ç›® | æ±ºå®šå†…å®¹ |
|------|---------|
| èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ | **Auth0** |
| ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ | **Vercel** |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | **Vercel Postgres + Prisma ORM** |
| é–‹ç™ºä½“åˆ¶ | **2åä½“åˆ¶** |
| Phase 2 é–‹å§‹ | **2ãƒ¶æœˆä»¥å†…** |
| PoCå®Ÿè¨¼ | **åŠå¹´å¾Œ** |

### é–‹ç™ºã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

```
ç¾åœ¨ â”€â”¬â”€ 2ãƒ¶æœˆ â”€â”¬â”€ 2-3ãƒ¶æœˆ â”€â”¬â”€ 3-4ãƒ¶æœˆ â”€â”¬â”€ 1-2ãƒ¶æœˆ â”€â”¬â”€ PoC
      â”‚         â”‚           â”‚           â”‚          â”‚
   Phase 1   Phase 2     Phase 3     Phase 4    Phase 5  å®Ÿè¨¼å®Ÿé¨“
   (å®Œäº†)  (DBãƒ»èªè¨¼)  (APIé€£æº)  (AI/ML)   (æœ¬ç•ªæº–å‚™)  (åŠå¹´å¾Œ)
```

**ç´¯è¨ˆæœŸé–“**: ç´„8-11ãƒ¶æœˆã§PoCå®Ÿè¨¼æº–å‚™å®Œäº†äºˆå®š

---

**æœ€çµ‚æ›´æ–°**: 2024å¹´1æœˆ

